Adjust the layout of CFR
Rebase on upstream
